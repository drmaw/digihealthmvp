<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>ржЕрзНржпрж╛ржбржорж┐ржи ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб</title>
</head>
<body>

  <div style="float:right;">
    <select id="langSwitch">
      <option value="bn">ржмрж╛ржВрж▓рж╛</option>
      <option value="en">English</option>
    </select>
    <button id="logoutBtn">рж▓ржЧржЖржЙржЯ</button>
  </div>

  <h1 id="title">ржЕрзНржпрж╛ржбржорж┐ржи ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб</h1>
  <p id="welcome">рж╕рзНржмрж╛ржЧрждржо, ржЕрзНржпрж╛ржбржорж┐ржиред</p>

  <hr>

  <ul>
    <li><a href="admin-users.html">ЁЯСе ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛</a></li>
    <li><a href="admin-organizations.html">ЁЯПе ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛</a></li>
  </ul>

  <!-- Language -->
  <script type="module">
    const LANG = {
      bn: {
        title: "ржЕрзНржпрж╛ржбржорж┐ржи ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб",
        welcome: "рж╕рзНржмрж╛ржЧрждржо, ржЕрзНржпрж╛ржбржорж┐ржиред"
      },
      en: {
        title: "Admin Dashboard",
        welcome: "Welcome, Admin."
      }
    };

    const langSwitch = document.getElementById("langSwitch");
    const title = document.getElementById("title");
    const welcome = document.getElementById("welcome");

    function applyLang(lang) {
      title.innerText = LANG[lang].title;
      welcome.innerText = LANG[lang].welcome;
      localStorage.setItem("lang", lang);
    }

    const savedLang = localStorage.getItem("lang") || "bn";
    langSwitch.value = savedLang;
    applyLang(savedLang);

    langSwitch.addEventListener("change", () => applyLang(langSwitch.value));
  </script>

  <!-- Firebase + Guard + Logout -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBqUDMQgc57d4wWSW2auFyYCS19q8vxBU4",
      authDomain: "digihealth-65f04.firebaseapp.com",
      projectId: "digihealth-65f04",
      storageBucket: "digihealth-65f04.appspot.com",
      messagingSenderId: "704628949252",
      appId: "1:704628949252:web:b38a476bd9c4259f829051"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.location.href = "/index.html";
        return;
      }
      const snap = await getDoc(doc(db, "users", user.uid));
      if (!snap.exists() || snap.data().role_id !== "admin") {
        await signOut(auth);
        window.location.href = "/index.html";
      }
    });

    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "/index.html";
    });
  </script>

</body>
</html>
